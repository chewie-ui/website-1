extends layouts/main

block links
    link(rel="stylesheet", href="/css/pages/message.css")

block content
    div.block.default-p-t
        .container
            .messaging-container
                .messaging-users
                    if chats
                        each chat in chats
                            .messaging-box

                    if friends
                        each friend in friends
                            .friend-box(data-id=friend._id data-name=`${friend.surname} ${friend.name}` data-avatar=friend.avatar)
                                .friend-avatar
                                    img(src=friend.avatar || "/images/default-pp.jpg")
                                .friend-infos
                                    p #{friend.surname} #{friend.name}
                                    .infos-msg 
                                        p Last message... dsdsqdsqdsqdsqds
                                        p 18h ago


                .messaging-chat
                    .chat-receipter-infos
                        .infos-receipter
                            .receipter-img
                                img#convAvatar(src="/images//default-pp.jpg")
                            .receipter-name
                                p#convName Jean Jean

                    .chat-box-render#chatMessages
                        .message-box-container.receipter
                            div.message-box
                                p Testfuedzhftrjeizourio dzsrdf ezrfeztrfezrtgyfezbvhurndejiz; 
                        .message-box-container.receiver
                            div.message-box
                                p EZJUEHGBZYUERHZEUfrje diofjndio fjgiod jgfniodf jgffiojg oiferjg iorejtgoirejtrejtpreu hjtgopefkg ikofdnhg ijfdjgopfd jngijdfj gjf oik 
                   
                    .chat-user-infos
                        .box-field
                            .field-button
                                button.button.secondary.flex
                                    svg(xmlns="http://www.w3.org/2000/svg" height="21" viewBox="0 -960 960 960" width="21" fill="#333")
                                        path(d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z")
                            .field-input
                                input.input(placeholder='Write here...')
                            button.button#sendMessage Send



block scripts
    script(src="/js/layouts/message.js")
    script.
        document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("sendMessage");
        if (!btn) return console.log("âŒ Bouton introuvable");

        btn.addEventListener("click", () => {
            socket.emit("chat message", "message test", "userezez", "zizi user");
        });
        });

        socket.on('chat message', ({msg,from,to}) =>{
            console.log({msg,from,to})
        })
    script.
         window.currentUserId = "!{user._id}";
